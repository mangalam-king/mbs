<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>MBS Mats. Bank â€“ Online Account Opening</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  font-family: Arial, sans-serif;
  background: linear-gradient(135deg,#e7f0ff,#f9fbff);
  padding:20px;
}
form{
  max-width:950px;
  margin:auto;
  background:#fff;
  padding:30px;
  border-radius:22px;
  box-shadow:0 15px 35px rgba(0,0,0,.12);
}
h2{
  text-align:center;
  color:#003366;
}
h3{
  margin-top:35px;
  color:#003366;
  border-bottom:2px solid #003366;
  padding-bottom:6px;
}
.row{
  display:flex;
  gap:25px;
  margin-top:20px;
  flex-wrap:wrap;
}
input,select,textarea{
  flex:1;
  min-width:calc(33% - 20px);
  padding:14px;
  border-radius:16px;
  border:1px solid #ccc;
  font-size:14px;
}
textarea{min-width:100%}
input[readonly]{background:#f3f7ff}
button{
  width:100%;
  margin-top:40px;
  padding:18px;
  font-size:18px;
  border:none;
  border-radius:18px;
  background:#003366;
  color:white;
  cursor:pointer;
}
button:hover{background:#0055aa}
.note{
  font-size:13px;
  color:#555;
  margin-top:10px;
}
@media(max-width:700px){
  input,select{min-width:100%}
}
</style>
</head>

<body>

<form action="https://formspree.io/f/xbdyeagw" method="POST" enctype="multipart/form-data">

<h2>MBS Mats. Bank<br>Online Account Opening</h2>

<!-- PERSONAL INFORMATION -->
<h3>Personal Information</h3>
<div class="row">
  <input name="first_name" placeholder="First Name" required>
  <input name="middle_name" placeholder="Middle Name">
  <input name="last_name" placeholder="Last Name" required>
</div>

<div class="row">
  <input name="guardian_name" placeholder="Father / Guardian Name" required>
  <input type="date" name="dob" required>
  <select name="gender" required>
    <option value="">Gender</option>
    <option>Male</option>
    <option>Female</option>
    <option>Other</option>
  </select>
</div>

<div class="row">
  <input type="tel" name="mobile" placeholder="Mobile Number" required>
  <input type="email" name="email" placeholder="Email Address">
</div>

<!-- ACCOUNT DETAILS -->
<h3>Account Details</h3>
<div class="row">
  <select id="account_type" name="account_type" required>
    <option value="">Select Account Type</option>
    <option>Savings Account</option>
    <option>Current Account</option>
    <option>Student Account</option>
    <option>Minor Account</option>
    <option>Zero Balance Account</option>
  </select>

  <input id="account_no" name="account_number" placeholder="Account Number" readonly required>
  <input id="open_date" name="opening_date" readonly>
</div>

<!-- ADDRESS -->
<h3>Address & Branch Details</h3>
<div class="row">
  <select id="state" name="state" required>
    <option value="">Select State</option>
  </select>

  <select id="district" name="district" required>
    <option value="">Select District</option>
  </select>

  <input id="place" name="place" placeholder="Village / City / Area" required>
</div>

<div class="row">
  <input id="pincode" name="pincode" placeholder="PIN Code" readonly>
  <input id="ifsc" name="ifsc_code" placeholder="IFSC Code" readonly>
</div>

<div class="row">
  <textarea name="full_address" placeholder="Complete Residential Address" required></textarea>
</div>

<!-- SIGNATURE -->
<h3>Signature Upload</h3>
<div class="row">
  <input type="file" name="signature" accept="image/*" required>
</div>

<p class="note">
No PAN / Aadhaar required. Demo / educational banking interface.
</p>

<button type="submit">Create Account</button>

</form>

<script>
// Opening date
document.getElementById("open_date").value =
  new Date().toISOString().split("T")[0];

// Account number logic
const accMap={
  "Savings Account":"1001",
  "Current Account":"2001",
  "Student Account":"4001",
  "Minor Account":"3001",
  "Zero Balance Account":"5001"
};

document.getElementById("account_type").addEventListener("change",e=>{
  const code=accMap[e.target.value]||"9999";
  const rnd=Math.floor(100000+Math.random()*900000);
  document.getElementById("account_no").value=`MBS-${code}-${rnd}`;
});

// ===== STATE & DISTRICT (FIXED BUG) =====
const stateSel=document.getElementById("state");
const districtSel=document.getElementById("district");

fetch("https://cdn.jsdelivr.net/npm/india-state-district@latest/state_district.json")
.then(res=>res.json())
.then(data=>{
  data.forEach(item=>{
    const opt=document.createElement("option");
    opt.value=item.state;
    opt.textContent=item.state;
    stateSel.appendChild(opt);
  });

  stateSel.addEventListener("change",()=>{
    districtSel.innerHTML='<option value="">Select District</option>';
    const selected=data.find(s=>s.state===stateSel.value);
    if(!selected) return;

    selected.districts.forEach(d=>{
      const opt=document.createElement("option");
      opt.value=d;
      opt.textContent=d;
      districtSel.appendChild(opt);
    });
  });
});

// ===== PINCODE (ALL INDIA) =====
document.getElementById("place").addEventListener("blur",()=>{
  if(!stateSel.value||!districtSel.value) return;

  const query=`${place.value}, ${districtSel.value}, ${stateSel.value}, India`;

  fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(query)}`)
  .then(res=>res.json())
  .then(result=>{
    if(result[0]){
      fetch(`https://nominatim.openstreetmap.org/details.php?format=json&place_id=${result[0].place_id}`)
      .then(r=>r.json())
      .then(info=>{
        if(info.address && info.address.postcode){
          document.getElementById("pincode").value=info.address.postcode;
        }
      });
    }
  });
});

// ===== IFSC GENERATION =====
districtSel.addEventListener("change",()=>{
  if(!stateSel.value||!districtSel.value) return;
  document.getElementById("ifsc").value=
    "MBS0"+
    stateSel.value.substring(0,2).toUpperCase()+
    districtSel.value.substring(0,2).toUpperCase()+
    "01";
});
</script>

</body>
</html>
